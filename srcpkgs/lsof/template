# Template file for 'lsof'
pkgname=lsof
version=4.98.0
revision=2
build_style=gnu-configure
configure_args="--enable-security"
hostmakedepends=groff
checkdepends="util-linux procps-ng"
short_desc="LiSt Open Files"
maintainer="Subhaditya Nath <sn03.general@gmail.com>"
license="custom:lsof"
homepage="https://github.com/lsof-org/lsof"
changelog="https://raw.githubusercontent.com/lsof-org/lsof/master/00DIST"
distfiles="https://github.com/lsof-org/lsof/releases/download/${version}/lsof-${version}.tar.gz"
checksum=2f8efa62cdf8715348b8f76bf32abf59f109a1441df35c686d23dccdeed34d99

pre_check() {
	echo /etc/hostname: $( cat /etc/hostname )
	echo hostname: $( hostname )
	echo kernel: $( cat /proc/sys/kernel/hostname )
	echo /etc/hosts:
	cat /etc/hosts
	# Ensure tests always run
	ln -sf /bin/true tests/CkTestDB
}

do_check() {
	make check || cat test-suite.log
}

post_install() {
	vlicense COPYING
}
