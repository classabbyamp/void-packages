# Template file for 'libunicode'
pkgname=libunicode
version=0.6.0
revision=1
_ucd_version=16.0.0
build_style=cmake
build_helper="qemu"
configure_args="-DLIBUNICODE_TESTING=OFF"
hostmakedepends="python3"
makedepends="fmt-devel"
short_desc="Modern C++17 Unicode library"
maintainer="0x5c <dev@0x5c.io>"
license="Apache-2.0"
homepage="https://github.com/contour-terminal/libunicode"
changelog="https://github.com/contour-terminal/libunicode/raw/master/Changelog.md"
distfiles="https://github.com/contour-terminal/libunicode/archive/refs/tags/v${version}.tar.gz
 https://www.unicode.org/Public/${_ucd_version}/ucd/UCD.zip>ucd-${_ucd_version}.zip"
checksum="0c217f8264000f1b8c36e78969cb9cf91ac97de937cc141ab78e6b1ad7f404ef
 c86dd81f2b14a43b0cc064aa5f89aa7241386801e35c59c7984e579832634eb2"
skip_extraction="ucd-${_ucd_version}.zip"

if [ "$XBPS_TARGET_WORDSIZE" -eq 32 ]; then
	broken="32bit architectures not currently supported, problems with SIMD"
fi

post_extract() {
	vsrccopy "ucd-${_ucd_version}.zip" _ucd
}

libunicode-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove usr/lib/cmake
	}
}
